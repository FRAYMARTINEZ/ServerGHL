{"ast":null,"code":"var _jsxFileName = \"D:\\\\podoscope\\\\src\\\\mainView\\\\MainView.jsx\";\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport './MainView.css';\nimport Grid from '@material-ui/core/Grid';\nimport Modal from '@material-ui/core/Modal';\nimport Backdrop from '@material-ui/core/Backdrop';\nimport Fade from '@material-ui/core/Fade';\nimport Fab from '@material-ui/core/Fab';\nimport SearchIcon from '@material-ui/icons/Search';\nimport InfoIcon from '@material-ui/icons/Info';\nimport UserCard from './UserInfo/UserCard';\nimport ImageSelection from './UserInfo/ImageSelection';\nimport CamCanvas from './Cam/CamCanvas';\nimport SearchUser from './SearchUser';\nimport LoadingCard from './LoadingCard';\nimport Drops from './UserInfo/Drops/Drops';\nimport MyObservations from './UserInfo/MyObservations';\nimport ImageModal from './ImageModal/ImageModal';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport { postPodImage } from '../utils/requestsManager';\nimport Menu from './Menu/Menu';\nexport default class MainView extends Component {\n  constructor(props) {\n    super(props);\n    this.canvasRef = React.createRef();\n    this.imageselRef = React.createRef();\n    this.obsRef = React.createRef();\n    this.obsRefReal = React.createRef();\n    this.shoeRef = React.createRef();\n    this.dropsRef = React.createRef();\n    this.state = {\n      open: false,\n      openImage: false,\n      savingImage: false,\n      user: {\n        name: '-',\n        cedula: '-',\n        cellphone: '-',\n        email: '-',\n        dob: '-',\n        sex: '-',\n        left: {},\n        right: {}\n      },\n      feet: {\n        left: {\n          footprintType: 'NEUTRO',\n          heelType: 'NEUTRO',\n          footType: 'NEUTRO'\n        },\n        right: {\n          footprintType: 'NEUTRO',\n          heelType: 'NEUTRO',\n          footType: 'NEUTRO'\n        }\n      },\n      shoeSize: 0,\n      threshold: (() => {\n        const th = localStorage.getItem('threshold');\n\n        if (th && th !== 'undefined') {\n          return JSON.parse(th);\n        } else {\n          const nth = {\n            value: 15\n          };\n          localStorage.setItem('threshold', JSON.stringify(nth));\n          return nth;\n        }\n      })()\n    };\n    this.toggleModal = this.toggleModal.bind(this);\n    this.toogleImageModal = this.toogleImageModal.bind(this);\n    this.savePhoto = this.savePhoto.bind(this);\n    this.selectImage = this.selectImage.bind(this);\n    this.setUser = this.setUser.bind(this);\n    this.setFeetInfo = this.setFeetInfo.bind(this);\n    this.setShoeSize = this.setShoeSize.bind(this);\n    this.setThreshold = this.setThreshold.bind(this);\n    this.setImageInMainView = this.setImageInMainView.bind(this);\n    this.imageIndex = -1;\n    this.images = [{}, {}, {}, {}, {}, {}];\n    this.observations = '--';\n  }\n\n  setImageInMainView(imIndex, imageData) {\n    this.images[imIndex] = imageData;\n  }\n\n  setShoeSize(newShoeSize) {\n    this.setState({\n      shoeSize: newShoeSize\n    });\n  }\n\n  setFeetInfo(data) {\n    this.setState({\n      feet: data\n    });\n  }\n\n  toogleImageModal() {\n    this.setState(prevState => ({\n      openImage: !prevState.openImage\n    }));\n  }\n\n  selectImage(index) {\n    console.log('Selecting image...');\n    console.log('Images in main veiw:');\n    console.log(this.images);\n    this.imageIndex = index;\n    this.canvasRef.setImg(this.images[this.imageIndex]);\n  }\n\n  toggleModal() {\n    console.log('Toggling modal');\n    this.setState(prevState => ({\n      open: !prevState.open\n    }));\n  }\n\n  setUser(newUser) {\n    this.setState({\n      user: newUser,\n      feet: {\n        left: {\n          footprintType: 'NEUTRO',\n          heelType: 'NEUTRO',\n          footType: 'NEUTRO'\n        },\n        right: {\n          footprintType: 'NEUTRO',\n          heelType: 'NEUTRO',\n          footType: 'NEUTRO'\n        }\n      }\n    }, () => {\n      this.canvasRef.resetInfo();\n      this.obsRefReal.resetInfo('');\n    });\n  }\n\n  savePhoto(data) {\n    if (this.imageIndex >= 0) {\n      this.setState({\n        savingImage: true\n      });\n      this.images[this.imageIndex] = data;\n      this.imageselRef.updateImage(this.imageIndex, data.image); // this unifies 2 objects into 1 object\n\n      postPodImage(Object.assign(this.state, {\n        imgData: data,\n        observations: this.obsRef.current,\n        shoeSize: this.state.shoeSize,\n        imId: this.imageIndex\n      }), () => {}, () => {}, () => {\n        this.setState({\n          savingImage: false\n        });\n      }, () => {\n        console.log('COULD NOT SAVE IMAGE');\n        this.setState({\n          savingImage: false\n        });\n      });\n    }\n  }\n\n  setThreshold(value) {\n    this.setState(prev => {\n      prev.threshold.value = +value;\n      return prev;\n    }, () => localStorage.setItem('threshold', JSON.stringify(this.state.threshold)));\n  }\n\n  render() {\n    return (// try justify center and space around\n      React.createElement(\"div\", {\n        className: \"mainViewDiv\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }, React.createElement(Menu, {\n        logout: this.props.logout,\n        threshold: this.state.threshold,\n        setThreshold: this.setThreshold,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }), React.createElement(Grid, {\n        container: true,\n        spacing: 0,\n        justify: \"space-around\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      }, React.createElement(Grid, {\n        item: true,\n        xs: 4,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187\n        },\n        __self: this\n      }, React.createElement(Grid, {\n        container: true,\n        spacing: 0,\n        direction: \"column\",\n        alignItems: \"center\",\n        justify: \"center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188\n        },\n        __self: this\n      }, React.createElement(Grid, {\n        item: true,\n        xs: 12,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      }, React.createElement(UserCard, {\n        user: this.state.user,\n        setShoeSize: this.setShoeSize,\n        shoeSize: this.state.shoeSize,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      })), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196\n        },\n        __self: this\n      }), React.createElement(Grid, {\n        item: true,\n        xs: 12,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197\n        },\n        __self: this\n      }, React.createElement(ImageSelection, {\n        selectImage: this.selectImage,\n        ref: r => this.imageselRef = r,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198\n        },\n        __self: this\n      })), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }), React.createElement(Grid, {\n        item: true,\n        xs: 12,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }, React.createElement(Drops, {\n        feetInfo: this.state.feet,\n        setFeetInfo: this.setFeetInfo,\n        ref: r => this.dropsRef = r,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      })))), React.createElement(Grid, {\n        item: true,\n        xs: 5,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206\n        },\n        __self: this\n      }, React.createElement(CamCanvas, {\n        threshold: this.state.threshold,\n        savePhoto: this.savePhoto,\n        ref: r => this.canvasRef = r,\n        patientCedula: this.state.user.cedula,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 207\n        },\n        __self: this\n      }), React.createElement(MyObservations, {\n        obsRef: this.obsRef,\n        ref: r => this.obsRefReal = r,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212\n        },\n        __self: this\n      }))), React.createElement(Fab, {\n        color: \"primary\",\n        \"aria-label\": \"add\",\n        className: \"fab\",\n        onClick: () => this.setState({\n          open: true\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215\n        },\n        __self: this\n      }, React.createElement(SearchIcon, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220\n        },\n        __self: this\n      })), React.createElement(Modal, {\n        \"aria-labelledby\": \"transition-modal-title\",\n        \"aria-describedby\": \"transition-modal-description\",\n        className: \"modal\",\n        open: this.state.open,\n        onClose: () => this.setState({\n          open: true\n        }),\n        closeAfterTransition: true,\n        disableEnforceFocus: true,\n        disableAutoFocus: true,\n        BackdropComponent: Backdrop,\n        BackdropProps: {\n          timeout: 200\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223\n        },\n        __self: this\n      }, React.createElement(DialogContent, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234\n        },\n        __self: this\n      }, React.createElement(Fade, {\n        in: this.state.open,\n        className: \"modalContent\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236\n        },\n        __self: this\n      }, React.createElement(SearchUser, {\n        toggleModal: this.toggleModal,\n        setUser: this.setUser,\n        setFeetInfo: this.setFeetInfo,\n        obsRefReal: this.obsRefReal,\n        setShoeSize: this.setShoeSize,\n        selectImageRef: this.imageselRef,\n        setImageInMainView: this.setImageInMainView,\n        logout: this.props.logout,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 239\n        },\n        __self: this\n      })))), React.createElement(Modal // aria-labelledby=\"transition-modal-title\"\n      // aria-describedby=\"transition-modal-description\"\n      , {\n        className: \"modal\",\n        open: this.state.savingImage,\n        onClose: () => this.setState({\n          savingImage: true\n        }),\n        closeAfterTransition: true,\n        disableEnforceFocus: true,\n        disableAutoFocus: true,\n        BackdropComponent: Backdrop,\n        BackdropProps: {\n          timeout: 200\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 252\n        },\n        __self: this\n      }, React.createElement(DialogContent, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 263\n        },\n        __self: this\n      }, React.createElement(Fade, {\n        in: this.state.savingImage,\n        className: \"modalContent\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 264\n        },\n        __self: this\n      }, React.createElement(LoadingCard, {\n        renderText: \"Saving image...\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 267\n        },\n        __self: this\n      })))), React.createElement(Fab, {\n        color: \"primary\",\n        \"aria-label\": \"info\",\n        className: \"fabImage\",\n        onClick: () => this.setState({\n          openImage: true\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 272\n        },\n        __self: this\n      }, React.createElement(InfoIcon, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 277\n        },\n        __self: this\n      })), React.createElement(Modal, {\n        \"aria-labelledby\": \"transition-modal-title\",\n        \"aria-describedby\": \"transition-modal-description\",\n        className: \"imageModal\",\n        open: this.state.openImage,\n        onClose: () => this.setState({\n          openImage: false\n        }),\n        closeAfterTransition: true,\n        disableEnforceFocus: true,\n        disableAutoFocus: true,\n        BackdropComponent: Backdrop,\n        BackdropProps: {\n          timeout: 200\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 279\n        },\n        __self: this\n      }, React.createElement(DialogContent, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 290\n        },\n        __self: this\n      }, React.createElement(Fade, {\n        in: this.state.openImage,\n        className: \"imageModalContent\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 291\n        },\n        __self: this\n      }, React.createElement(ImageModal, {\n        toggleModal: this.toogleImageModal,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 294\n        },\n        __self: this\n      })))))\n    );\n  }\n\n}\nMainView.propTypes = {\n  logout: PropTypes.func.isRequired\n};","map":{"version":3,"sources":["D:/podoscope/src/mainView/MainView.jsx"],"names":["React","Component","PropTypes","Grid","Modal","Backdrop","Fade","Fab","SearchIcon","InfoIcon","UserCard","ImageSelection","CamCanvas","SearchUser","LoadingCard","Drops","MyObservations","ImageModal","DialogContent","postPodImage","Menu","MainView","constructor","props","canvasRef","createRef","imageselRef","obsRef","obsRefReal","shoeRef","dropsRef","state","open","openImage","savingImage","user","name","cedula","cellphone","email","dob","sex","left","right","feet","footprintType","heelType","footType","shoeSize","threshold","th","localStorage","getItem","JSON","parse","nth","value","setItem","stringify","toggleModal","bind","toogleImageModal","savePhoto","selectImage","setUser","setFeetInfo","setShoeSize","setThreshold","setImageInMainView","imageIndex","images","observations","imIndex","imageData","newShoeSize","setState","data","prevState","index","console","log","setImg","newUser","resetInfo","updateImage","image","Object","assign","imgData","current","imId","prev","render","logout","r","timeout","propTypes","func","isRequired"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport './MainView.css';\r\n\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Modal from '@material-ui/core/Modal';\r\nimport Backdrop from '@material-ui/core/Backdrop';\r\nimport Fade from '@material-ui/core/Fade';\r\nimport Fab from '@material-ui/core/Fab';\r\nimport SearchIcon from '@material-ui/icons/Search';\r\nimport InfoIcon from '@material-ui/icons/Info';\r\n\r\n\r\nimport UserCard from './UserInfo/UserCard';\r\nimport ImageSelection from './UserInfo/ImageSelection';\r\nimport CamCanvas from './Cam/CamCanvas';\r\nimport SearchUser from './SearchUser';\r\nimport LoadingCard from './LoadingCard';\r\nimport Drops from './UserInfo/Drops/Drops';\r\nimport MyObservations from './UserInfo/MyObservations';\r\nimport ImageModal from './ImageModal/ImageModal';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\n\r\n\r\nimport { postPodImage } from '../utils/requestsManager';\r\nimport Menu from './Menu/Menu';\r\n\r\n\r\nexport default class MainView extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.canvasRef = React.createRef();\r\n    this.imageselRef = React.createRef();\r\n    this.obsRef = React.createRef();\r\n    this.obsRefReal = React.createRef();\r\n    this.shoeRef = React.createRef();\r\n    this.dropsRef = React.createRef();\r\n\r\n    this.state = {\r\n      open: false,\r\n      openImage: false,\r\n      savingImage: false,\r\n      user: {\r\n        name: '-',\r\n        cedula: '-',\r\n        cellphone: '-',\r\n        email: '-',\r\n        dob: '-',\r\n        sex: '-',\r\n        left: {},\r\n        right: {}\r\n      },\r\n      feet: {\r\n        left: {\r\n          footprintType: 'NEUTRO',\r\n          heelType: 'NEUTRO',\r\n          footType: 'NEUTRO'\r\n        },\r\n        right: {\r\n          footprintType: 'NEUTRO',\r\n          heelType: 'NEUTRO',\r\n          footType: 'NEUTRO'\r\n        }\r\n      },\r\n      shoeSize: 0,\r\n      threshold: (() => {\r\n        const th = localStorage.getItem('threshold');\r\n        if (th && th !== 'undefined') {\r\n          return JSON.parse(th);\r\n        } else {\r\n          const nth = { value: 15 };\r\n          localStorage.setItem('threshold', JSON.stringify(nth));\r\n          return nth;\r\n        }\r\n      })()\r\n    };\r\n    this.toggleModal = this.toggleModal.bind(this);\r\n    this.toogleImageModal = this.toogleImageModal.bind(this);\r\n    this.savePhoto = this.savePhoto.bind(this);\r\n    this.selectImage = this.selectImage.bind(this);\r\n    this.setUser = this.setUser.bind(this);\r\n    this.setFeetInfo = this.setFeetInfo.bind(this);\r\n    this.setShoeSize = this.setShoeSize.bind(this);\r\n    this.setThreshold = this.setThreshold.bind(this);\r\n    this.setImageInMainView = this.setImageInMainView.bind(this);\r\n\r\n    this.imageIndex = -1;\r\n    this.images = [{}, {}, {}, {}, {}, {}];\r\n    this.observations = '--';\r\n  }\r\n\r\n  setImageInMainView(imIndex, imageData){\r\n    this.images[imIndex] = imageData;\r\n  }\r\n  setShoeSize(newShoeSize) {\r\n    this.setState({ shoeSize: newShoeSize });\r\n  }\r\n\r\n  setFeetInfo(data) {\r\n    this.setState({ feet: data });\r\n  }\r\n\r\n  toogleImageModal() {\r\n    this.setState(prevState => ({ openImage: !prevState.openImage }));\r\n  }\r\n\r\n  selectImage(index) {\r\n    console.log('Selecting image...');\r\n    console.log('Images in main veiw:');\r\n    console.log(this.images);\r\n\r\n    this.imageIndex = index;\r\n    this.canvasRef.setImg(this.images[this.imageIndex]);\r\n  }\r\n\r\n  toggleModal() {\r\n    console.log('Toggling modal');\r\n    this.setState((prevState) => ({ open: !prevState.open }));\r\n  }\r\n\r\n  setUser(newUser) {\r\n    this.setState(\r\n      {\r\n        user: newUser,\r\n        feet: {\r\n          left: {\r\n            footprintType: 'NEUTRO',\r\n            heelType: 'NEUTRO',\r\n            footType: 'NEUTRO'\r\n          },\r\n          right: {\r\n            footprintType: 'NEUTRO',\r\n            heelType: 'NEUTRO',\r\n            footType: 'NEUTRO'\r\n          }\r\n        }\r\n      },\r\n      () => {\r\n        this.canvasRef.resetInfo();\r\n        this.obsRefReal.resetInfo('');\r\n      });\r\n  }\r\n\r\n  savePhoto(data) {\r\n    if (this.imageIndex >= 0) {\r\n      this.setState({savingImage:true})\r\n      this.images[this.imageIndex] = data;\r\n      this.imageselRef.updateImage(this.imageIndex, data.image);\r\n\r\n\r\n      // this unifies 2 objects into 1 object\r\n      postPodImage(Object.assign(\r\n        this.state,\r\n        {\r\n          imgData: data,\r\n          observations: this.obsRef.current,\r\n          shoeSize: this.state.shoeSize,\r\n          imId: this.imageIndex\r\n        }), \r\n        () => {}, () => {},\r\n        () => { \r\n          this.setState({savingImage:false})\r\n        }, \r\n        () => { \r\n          console.log('COULD NOT SAVE IMAGE')\r\n          this.setState({savingImage:false})\r\n        });\r\n\r\n    }\r\n  }\r\n\r\n  setThreshold(value) {\r\n    this.setState((prev) => {\r\n      prev.threshold.value = +value;\r\n      return prev;\r\n    }, () => localStorage.setItem('threshold', JSON.stringify(this.state.threshold)));\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      // try justify center and space around\r\n      <div className='mainViewDiv'>\r\n        <Menu logout={this.props.logout} threshold={this.state.threshold} setThreshold={this.setThreshold} />\r\n        <Grid container spacing={0} justify='space-around' >\r\n          <Grid item xs={4} >\r\n            <Grid container\r\n              spacing={0}\r\n              direction=\"column\"\r\n              alignItems=\"center\"\r\n              justify=\"center\">\r\n              <Grid item xs={12}>\r\n                <UserCard user={this.state.user} setShoeSize={this.setShoeSize} shoeSize={this.state.shoeSize} />\r\n              </Grid>\r\n              <br />\r\n              <Grid item xs={12}>\r\n                <ImageSelection selectImage={this.selectImage} ref={r => this.imageselRef = r} />\r\n              </Grid>\r\n              <br />\r\n              <Grid item xs={12}>\r\n                <Drops feetInfo={this.state.feet} setFeetInfo={this.setFeetInfo} ref={r => this.dropsRef = r} />\r\n              </Grid>\r\n            </Grid>\r\n          </Grid>\r\n          <Grid item xs={5}>\r\n            <CamCanvas \r\n              threshold={this.state.threshold} \r\n              savePhoto={this.savePhoto} \r\n              ref={r => this.canvasRef = r} \r\n              patientCedula={this.state.user.cedula} />\r\n            <MyObservations obsRef={this.obsRef} ref={r => this.obsRefReal = r} />\r\n          </Grid>\r\n        </Grid>\r\n        <Fab\r\n          color=\"primary\"\r\n          aria-label=\"add\"\r\n          className=\"fab\"\r\n          onClick={() => this.setState({ open: true })}>\r\n          <SearchIcon />\r\n        </Fab>\r\n\r\n        <Modal\r\n          aria-labelledby=\"transition-modal-title\"\r\n          aria-describedby=\"transition-modal-description\"\r\n          className=\"modal\"\r\n          open={this.state.open}\r\n          onClose={() => this.setState({ open: true })}\r\n          closeAfterTransition\r\n          disableEnforceFocus\r\n          disableAutoFocus\r\n          BackdropComponent={Backdrop}\r\n          BackdropProps={{ timeout: 200 }}>\r\n          <DialogContent>\r\n            \r\n            <Fade\r\n              in={this.state.open}\r\n              className='modalContent'>\r\n              <SearchUser\r\n                toggleModal={this.toggleModal}\r\n                setUser={this.setUser}\r\n                setFeetInfo={this.setFeetInfo}\r\n                obsRefReal={this.obsRefReal}\r\n                setShoeSize={this.setShoeSize}\r\n                selectImageRef={this.imageselRef}\r\n                setImageInMainView={this.setImageInMainView}\r\n                logout={this.props.logout}\r\n              />\r\n            </Fade>\r\n          </DialogContent>\r\n        </Modal>\r\n        <Modal\r\n          // aria-labelledby=\"transition-modal-title\"\r\n          // aria-describedby=\"transition-modal-description\"\r\n          className=\"modal\"\r\n          open={this.state.savingImage}\r\n          onClose={() => this.setState({ savingImage: true })}\r\n          closeAfterTransition\r\n          disableEnforceFocus\r\n          disableAutoFocus\r\n          BackdropComponent={Backdrop}\r\n          BackdropProps={{ timeout: 200 }}>\r\n          <DialogContent>\r\n            <Fade\r\n              in={this.state.savingImage}\r\n              className='modalContent'>\r\n              <LoadingCard renderText='Saving image...'/>\r\n            </Fade>\r\n          </DialogContent>\r\n        </Modal>\r\n\r\n        <Fab\r\n          color=\"primary\"\r\n          aria-label=\"info\"\r\n          className=\"fabImage\"\r\n          onClick={() => this.setState({ openImage: true })}>\r\n          <InfoIcon />\r\n        </Fab>\r\n        <Modal\r\n          aria-labelledby=\"transition-modal-title\"\r\n          aria-describedby=\"transition-modal-description\"\r\n          className=\"imageModal\"\r\n          open={this.state.openImage}\r\n          onClose={() => this.setState({ openImage: false })}\r\n          closeAfterTransition\r\n          disableEnforceFocus\r\n          disableAutoFocus\r\n          BackdropComponent={Backdrop}\r\n          BackdropProps={{ timeout: 200 }}>\r\n          <DialogContent>\r\n            <Fade\r\n              in={this.state.openImage}\r\n              className='imageModalContent'>\r\n              <ImageModal toggleModal={this.toogleImageModal} />\r\n            </Fade>\r\n          </DialogContent>\r\n        </Modal>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nMainView.propTypes = {\r\n  logout: PropTypes.func.isRequired\r\n};\r\n"]},"metadata":{},"sourceType":"module"}